{"version":3,"sources":["socket.js","components/JoinBlock.jsx","reducer.js","components/Chat.jsx","App.js","index.js"],"names":["socket","io","JoinBlock","onLogin","React","useState","roomId","setRoomId","userName","setUserName","isLoading","setLoading","onEnter","a","alert","obj","axios","post","className","type","placeholder","value","onChange","e","target","disabled","onClick","state","action","joined","payload","users","messages","Chat","onAddMessage","messageValue","setMessageValue","messagesRef","useRef","useEffect","current","scrollTo","length","map","name","index","ref","message","text","rows","emit","App","useReducer","reducer","dispatch","get","data","setUsers","addMessage","on","window","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5ac2c503.chunk.js","sourcesContent":["import io from \"socket.io-client\";\r\n\r\nconst socket = io();\r\n\r\nexport default socket;","import axios from \"axios\";\r\nimport React from \"react\";\r\nimport socket from \"../socket\";\r\n\r\nconst JoinBlock = ({ onLogin }) => {\r\n  const [roomId, setRoomId] = React.useState(\"\");\r\n  const [userName, setUserName] = React.useState(\"\");\r\n  const [isLoading, setLoading] = React.useState(false);\r\n\r\n  const onEnter = async () => {\r\n    if (!roomId || !userName) {\r\n      return alert(\"Wrong data\");\r\n    }\r\n    const obj = {\r\n      roomId,\r\n      userName,\r\n    };\r\n    setLoading(true);\r\n    await axios.post(\"/rooms\", obj);\r\n    onLogin(obj);\r\n  };\r\n  return (\r\n    <div className=\"join-block\">\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Room ID\"\r\n        value={roomId}\r\n        onChange={(e) => setRoomId(e.target.value)}\r\n      />\r\n      <input\r\n        type=\"text\"\r\n        placeholder=\"Your name\"\r\n        value={userName}\r\n        onChange={(e) => setUserName(e.target.value)}\r\n      />\r\n      <button\r\n        disabled={isLoading}\r\n        onClick={onEnter}\r\n        className=\"btn btn-success\"\r\n      >\r\n        {isLoading ? \"ENTERING...\" : \"ENTER\"}\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default JoinBlock;\r\n","export default (state, action) => {\r\n  switch (action.type) {\r\n    case \"JOINED\":\r\n      return {\r\n        ...state,\r\n        joined: true,\r\n        userName: action.payload.userName,\r\n        roomId: action.payload.roomId,\r\n      };\r\n    case \"SET_DATA\":\r\n      return {\r\n        ...state,\r\n        users: action.payload.users,\r\n        messages: action.payload.messages,\r\n      };\r\n    case \"SET_USERS\":\r\n      return {\r\n        ...state,\r\n        users: action.payload,\r\n      };\r\n    case \"SET_MESSAGES\":\r\n      return {\r\n        ...state,\r\n        messages: action.payload,\r\n      };\r\n    case \"NEW_MESSAGE\":\r\n      return {\r\n        ...state,\r\n        messages: [...state.messages, action.payload],\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import React, { useRef } from \"react\";\r\nimport socket from \"../socket\";\r\n\r\nfunction Chat({ users, messages, userName, roomId, onAddMessage }) {\r\n  const [messageValue, setMessageValue] = React.useState(\"\");\r\n  const messagesRef = React.useRef(null);\r\n\r\n  const onSendMessage = () => {\r\n    socket.emit(\"ROOM:NEW_MESSAGE\", { text: messageValue, roomId, userName });\r\n    onAddMessage({\r\n      userName,\r\n      text: messageValue,\r\n    });\r\n    setMessageValue(\"\");\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    messagesRef.current.scrollTo(0, 99999);\r\n  }, [messages]);\r\n\r\n  return (\r\n    <div className=\"chat\">\r\n      <div className=\"chat-users\">\r\n        Room: <b>{roomId}</b>\r\n        <hr />\r\n        <b>Online ({users.length}): </b>\r\n        <ul>\r\n          {users.map((name, index) => (\r\n            <li key={name + index}>{name}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <div className=\"chat-messages\">\r\n        <div ref={messagesRef} className=\"messages\">\r\n          {messages.map((message) => (\r\n            <div className=\"message\">\r\n              <p>{message.text}</p>\r\n              <div>\r\n                <span>{message.userName}</span>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <form>\r\n          <textarea\r\n            value={messageValue}\r\n            onChange={(e) => setMessageValue(e.target.value)}\r\n            className=\"form-control\"\r\n            rows=\"3\"\r\n          ></textarea>\r\n          <button\r\n            onClick={onSendMessage}\r\n            type=\"button\"\r\n            className=\"btn btn-primary\"\r\n          >\r\n            Отправить\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n","import React from \"react\";\nimport socket from \"./socket\";\nimport JoinBlock from \"./components/JoinBlock\";\nimport reducer from \"./reducer\";\nimport Chat from \"./components/Chat\";\nimport axios from \"axios\";\n\nfunction App() {\n  const [state, dispatch] = React.useReducer(reducer, {\n    joined: false,\n    roomId: null,\n    userName: null,\n    users: [],\n    messages: [],\n  });\n\n  const onLogin = async (obj) => {\n    dispatch({\n      type: \"JOINED\",\n      payload: obj,\n    });\n    socket.emit(\"ROOM:JOIN\", obj);\n    const { data } = await axios.get(`/rooms/${obj.roomId}`);\n    dispatch({\n      type: \"SET_DATA\",\n      payload: data,\n    });\n  };\n\n  const setUsers = (users) => {\n    dispatch({\n      type: \"SET_USERS\",\n      payload: users,\n    });\n  };\n\n  const addMessage = (message) => {\n    dispatch({\n      type: \"NEW_MESSAGE\",\n      payload: message,\n    });\n  };\n\n  React.useEffect(() => {\n    socket.on(\"ROOM:SET_USERS\", setUsers);\n    socket.on(\"ROOM:NEW_MESSAGE\", addMessage);\n  }, []);\n\n  window.socket = socket;\n\n  return (\n    <div className=\"wrapper\">\n      {!state.joined ? (\n        <JoinBlock onLogin={onLogin} />\n      ) : (\n        <Chat {...state} onAddMessage={addMessage} />\n      )}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}